# 0. Стартовая позиция

Имеется проект **NoteD.**, необходимо изменить его под новые настоящие требования проекта. 

# 1. Цель проекта

**Цель проекта** — разработать систему (далее Система) создания, хранения и поиска конспектов (далее запись) для пользователей.

Запись — конспект, резюме какого-либо материала (далее Источника), например: книги, видео, курса, статьи и т.д.
Пользователь сможет искать публичные записи по названию, либо по Источнику. Пользователь сможет создавать записи, открывать и закрывать к ним доступ, подписываться на других пользователей.

Польза этого проекта в том, что человек изучающий какой-либо материал сокращает время на ведения записей. Он может:
- искать записи других людей;
- начинать писать записи с чужих записей;
- изучать материал в краткой форме, по чужим записям.

# 2. Описание системы

Система состоит из следующих основных функциональных блоков:

1. Регистрация, аутентификация и авторизация
2. Функционал для работы с записями и источниками
3. Функционал для работы с тэгами
4. Функционал поиска
5. Функционал работы с профилем пользователя
6. Функционал действий пользователя
7. Уведомления

## 2.1.1. Регистрация 

Процесс регистрации пользователей должен быть реализован в интерфейсах Системы. Регистрация осуществляется двумя способами: через формы сайта или через сторонние сайты.

При регистрации пользователя через формы должны быть запрошены следующие поля:

* email — обязательное поле (уникальное на сайте)
* username — обязательное поле (уникальное на сайте)
* имя и фамилия  — опциональные поле
* password — обязательное поле

Список сторонних сайтов для регистрации:

- Google
- Yandex
- VK
- GitHub

После отправки формы регистрации подписчика ему на email приходит
письмо с первым кодом, по которому он может войти. Аутентификация будет
происходить по разовым кодам, приходящим на email.

## 2.1.2. Аутентификация

Аутентификация пользователей осуществляется по email и одноразовому
паролю (или по одноразовой ссылке), который приходит на этот email. Без аутентификации пользователь не может создавать публичные записи и оставлять комментарии.

## 2.1.3. Авторизация

Авторизация производится при помощи формы или стороннего сайта.

При авторизации запрашиваются следующие данные:

- username или email
- password

Если пользователь забыл пароль, предусматривается восстановление пароля по email адресу.

## 2.2. Функционал для работы с записями и Источниками

Пользователь после авторизации получает доступ к своему авторскому функционалу в Системе. Этот функционал состоит из следующих блоков:

1. Создание Источника
2. Создание записи
3. Редактирование записи
4. Удаление записи
5. Копирование записи с возможностью редактировать
6. Скачивание записи в формате PDF на компьютер
7. Просмотр списков записей

### 2.2.1. Создание Источника

Источником является материал с которого берут записи. Источник создается в форме создания записи.

Пользователь может производить поиск по существующим Источникам. Каждый Источник имеет кнопку, по которой открывается форма создания записи с предзаполненым Источником. Также можно производить поиск Источника в форме создания записи, вводя запрос в поля ввода Источника. Существующие источники будут появляться в всплывающем окне и будут доступны для выбора.
Если Источника не существует, то при создании первой записи на указанный в форме создания записи Источник, создается этот Источник.
Не может существовать Источник на который нет ни одной записи, такой автоматически удаляется.
Типы источников определены в Системе и не имеется возможность их расширения со стороны пользователя.

Поле для создания источника (находится в форме создания записи):

- название источника
- тип источника (книга, видео, курс и т.д.)
- ссылка (URL) на источник

Поля, которые создаются и заполняются автоматически:

- slug — уникальная ссылка для записи (на основе названия Источника + соль, если будет занято)

### 2.2.2. Создание записи

Пользователь создает записи с помощью формы. Запись создается с помощью синтаксиса Markdown.

При создании записи пользователь заполняет следующие поля:

- Источник (опциональный) — ссылка на Источник
- название записи (обязательный)
- тело записи (обязательный)
- краткое изложение (опциональный)
- флаг приватности (опциональный) — публичная запись или приватная
- флаг анонимности (опциональный) — указывается автор у записи или нет
- флаг комментариев (опциональный) — можно ли оставлять комментарии
- тэги (опциональный)

Поля, которые создаются и заполняются автоматически:

- slug — уникальная ссылка для записи (на основе названия записи + соль, если будет занято)
- автор
- дата создания
- дата изменения
- лайки — ссылка на пользователей
- закладки — ссылка на пользователей
- количество просмотров записи

### 2.2.3. Редактирование записи

Редактирование записи происходит в такой же форме как и создание.

### 2.2.4. Удаление записи

Удаление записи происходит по нажатию кнопки. После удаления записи удаляются все комментарии, тэги и Источники (если они были привязаны только к удаляемой записи).

### 2.2.5. Копирование записи с возможностью редактировать

Пользователь имеет возможность скопировать публичную запись в свои записи и редактировать её (по аналогии с fork). Скопированная запись не имеет дополнительной информации, указывающей на оригинальную запись.

### 2.2.6. Скачивание записи в формате PDF на компьютер

Пользователь может скачивать любую публичную запись в формате pdf на своё устройство.

### 2.2.7. Просмотр списков записей

Пользователь может просматривать различные списки публичных и своих записей. Управление списком находится на одной странице. Все списки имеют функцию сортировки. Сортировка выдает результат от большего к меньшему и не имеет реверсивной функции.

Методы сортировки:

- По дате создания (самые новые)
- По количеству просмотров
- По количеству лайков
- По количеству комментарией

Виды списков:

- Собственные записи
- Записи пользователя на странице профиля
	- На странице профиля выводятся 3 самые популярные записи и кнопка на обычную страницу с всеми его публичными записями
- Публичные записи
- Записи тех, на кого подписан
- Записи отдельного Источника
- Записи отдельного типа Источника
- Записи отдельного тэга 

## 2.3. Функционал для работы с тэгами

Тэги привязываются к записям. Теги создаются в момент добавления их к записи в форме создания записи и удаляются, когда нет записей привязанной к тегу.

## 2.4. Функционал поиска

Поиск осуществляется на отдельной странице. Перед началом поиска, необходимо выбрать тип поиска (по умолчанию производится общий поиск).

Типы поиска:

- Общий (включает название записи, тело записи, краткое изложение записи, название источника, название тегов)
- По записи (включает название записи, тело записи, краткое изложение записи)
- По названию источника
- По ссылке на источник
- По тэгу

Существует отдельный поиск по пользователям.

## 2.5. Функционал работы с профилем пользователя

Пользователь после авторизации получает доступ к своему профилю. Этот функционал состоит из следующих блоков:

1. Создание профиля
2. Редактирование данных профиля
3. Удаление профиля

### 2.5.1. Создание профиля

Профиль создается в момент регистрации. В Системе профиль включает данные из двух моделей — пользователя и его профиля.

Пользователь имеет следующие поля в Системе:

- email
- username
- пароль
- имя и фамилия
- флаг подтверждения email'а
- флаг суперпользователя
- last login
- дата регистрации

Профиль имеет следующие поля в Системе:

- аватар
- био
- локация — (страна, город)
- ссылки на социальные сети
	- vk
	- instagram
	- twitter
- пол
- флаг видимости подписчиков

При просмотре профиля любой видит следующие данные профиля: username, имя и фамилию, last login, дата регистрации, аватар, био, локация, ссылки на соц. сети, пол.

### 2.5.2. Редактирование профиля

Пользователь имеет возможность редактировать следующие данные без ограничений:

- имя и фамилия
- аватар
- био
- локация
- ссылки на соц. сети
- пол
- флаг видимости подписчиков

Дополнительные условия запрашиваются при редактировании следующих данных:

- email  — проверка на уникальность + подтверждение на новом email'е
- username  — проверка на уникальность 
- пароль — ввод старого пароля

### 2.5.3. Удаление профиля

Профиль удаляется по запросу пользователя полностью, без возможности восстановить. Однако пользователь может решить удалять все его записи из Системы или оставить их там под анонимным автором. Если пользователь оставляет записи, они не ссылаются на автора и действия над ними может проводить только администратор. 

## 2.6. Функционал действий пользователя

1. Оставить комментарий к записи
2. Удалить комментарий у записи
3. Поставить лайк записи
4. Поставить лайк комментарию
5. Добавить запись в избранное
6. Поделиться записью в социальной сети
	- VK
	- Twitter
	- WhatsApp
	- Telegram
7. Просматривать профиль пользователей
8. Подписаться на пользователя
9. Подписаться на тег

### 2.6.1. Оставить комментарий к записи

Пользователь может оставлять комментарии к публичным записям, которые имеют разрешения на оставление комментариев. Если пользователь закрывает комментарии, они сохраняются, но не показываются при просмотре записи. После того, как пользователь снова открывает комментарии к записи, все старые комментарии отображаются.

Система комментариев древовидная, имеющая всего два уровня — родителя и потомков. Потомки создаются при ответе на чужой комментарий, при этом если пользователь отвечает на комментарий потомок, то создается комментарий, родителем которого будет родительский комментарий, на который отвечает пользователь. В ответах на чужой комментарий должна появляться ссылка на пользователя, которому вы отвечаете.

Поля комментария:

- ссылка на запись
- ссылка на комментарий родителя
- тело комментария
- автор
- дата
- ссылка на комментарий на который отвечают

### 2.6.2. Удалить комментарий

Удалить комментарий может только автор комментария, при этом все ответы на этот комментарий сохраняются, за исключением, если комментарий является родительским.

### 2.6.3. Добавить запись в избранное

Пользователь имеет возможность добавлять публичную запись в избранное и просматривать список избранных записей. Список доступен только пользователю. Должна быть реализована возможность добавления записи в избранное без открытия страницы записи, а из списка.

### 2.7.4. Просматривать профили пользователей

Пользователь может зайти на чужой профиль и просматривать открытую информацию.

На странице профиля выводится следующая информация:

- username
- имя и фамилия
- last login
- дата регистрации
- аватар
- био
- локация — (страна, город)
- ссылки на социальные сети
	- vk
	- instagram
	- twitter
- пол
- подписчики и подписки
- 3 записи с самым большим количеством лайков
- общее количество лайков со всех записей


### 2.6.5. Подписаться на пользователя

Пользователь может подписаться на пользователя и получать уведомления о новых записях. Список подписчиков виден всем, список подписок можно скрыть.

### 2.6.6. Подписаться на тэг

Пользователь может подписаться на существующий тег и получать уведомления о создании записей с данным тэгом, при удалении тега подписка пропадает.

## 2.7. Уведомления

Пользователь получает уведомления при определенных событиях. Уведомления приходят на сайт. \[В будущем можно добавить уведомления на email]. Есть возможность настройки уведомлений. Уведомления можно просматривать на отдельной странице. Ведется счётчик непросмотренных уведомлений.

Пользователь может получать уведомления о следующих событиях:

- На пользователя подписались
- Записи пользователя поставили лайк
- К записи пользователя добавили комментарий
- На комментарий пользователя ответили
- Пользователь на которого подписаны, создал новую запись

# 3. Предлагаемый стек технологий

Для реализации системы предлагается следующий стек технологий:

* Бэкенд:
    - Язык Python
    - Фреймворк Django
    - БД PostgreSQL
    - Django ORM
    - Gunicorn
    - Nginx
    - Docker
* Фронтенд:
    - Bootstrap

# 4. Требования к дизайну

**Общие требования:**

- Минимализм
- Лаконичность
- Акцент на контент
- Два языка (русский, английский)
- Тёмная и светлая темы
- Отдельные логические блоки должны быть максимально независимы (меню, управляющие панели, контент и т.д.), чтобы можно было вырвать отдельный блок и сайт сильно не сломался

## 4.1 Навигация

Находится в левой части, привязана к просматриваемой области пользователя. Обязательно присутствует логотип. При узком экране сворачивается в развертывающееся меню и перемещается на верх сайта.

Управляющие элементы это иконки (кнопки) имеющие tooltip (справа) с текстовым представлением иконки.

Ссылки и элементы:

- Верх:
	- Логотип ведет на главную страницу
- Середина
	- Ссылка на главную страницу (середина)
	- Ссылка на страницу с уведомлениями (середина)
	- Ссылка на закладки
	- Ссылка на страницу с личными записями (середина)
	- Декоративная полоска (середина)
	- Кнопка для создания записи (середина)
- Низ
	- Круглая картинка профиля с раскрывающимся меню.

Раскрывающееся меню профиля:

- Ссылка на профиль
- Настройки профиля
- Кнопка выйти из профиля
- Переключатель языка
- Переключатель темы

## 4.2. Стартовая страница

Представительская страница сайта. На неё попадает пользователи не прошедшие авторизацию.
На странице недоступно навигационное меню. Важно сохранить волны (они мне нравятся). В шапке должен быть большой логотип, девиз и заметные кнопки (переход на главную страницу, войти, зарегистрироваться). 

Что ниже можно вывести список самых популярных тегов, записей и т.п. Или туториал как создавать записи и искать по источникам. Тут надо подумать.

## 4.3. Главная страница

На главной странице размещается основной контент — список записей и элементы управления.  Дизайн повторяет сайт **medium.com**. Главная страница подгружает контент по мере продвижения вниз и не достигает конца, пока контент не закончится.

![Medium](https://i.ibb.co/HFNRWvD/image.png)

**Управляющая панель №1:**

- Вместо иконки плюса иконка сортировки. По нажатию открывающееся меню с вариантами сортировки.
- Закладки
	- Публичные записи (название надо подобрать, либо "публичные", либо просто "записи", либо ещё что-то более подходящее)
	- Подписки (там записи тех, на кого подписан)
	- Мои теги (теги на которые подписан)

**Управляющая панель №2:**

- Поле поиска
- Рекомендуемые теги (также как на скриншоте)
- Типы источников (также как теги, только с возможностью менять цвет бейджа)
- Подвал сайта

**Карточка записи:**

Запись может быть анонимна, тогда первая строка отсутствует. Может отсутствовать Источник, тогда надо куда-то перенести кнопку закладки. Краткое изложение может отсутствовать. Тэги могут отсутствовать.

![Note Card](https://i.ibb.co/pX3hTY7/2022-11-18-15-32-49.png)

Гиперссылка на следующих элементах:

- Аватар + имя (либо раздельно)
- Название записи (hover)
- Иконка закладки (tooltip)
- Тэг источника (hover)
- Название источника (hover)
- Краткое изложение (hover на название записи)
- Тэги записи (hover)
- Лайк (hover)
- Комментарий (hover)

**Подвал сайта:**

*Находится в конце управляющей панели №2, после декоративной линии. Шрифт чуть меньше стандартного.*

Содержит:

- Логотип
- Ссылки
	- О нас
	- Контакты
	- Политика конфиденциальности
- Иконки с ссылкой
	- GitHub
	- Gmail
	- Telegram
- Короткое сообщение
- NoteD. 2022-2023

...